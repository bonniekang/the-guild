  <div id="form" class="modal fade">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
         <div class="modal-header">
            <h1 class="modal-title">New Task Form</h1>
          </div>
          <div class="modal-body">
              <%= simple_form_for [@milestone, @task] do |f| %>
                <%= f.input :title, error: "A task must have a name more than 3 characters long." %>
                <%= f.input :description %>
                <%= f.association :user, :as => :select, :collection => @guild.members, :label_method => :email, :value_method => :id %>
                <%= f.submit %>
              <% end %>
            <%= link_to "back", guild_milestone_path(@milestone) %>
          </div>
      </div>
    </div>
  </div>

<div class="milestone-main">
  <div class="milestone-header">
    <div class="milestone-box1">
      <h1><%= @milestone.title %></h1>
      <h6><i class="fab fa-slack-hash"></i> <%= @milestone.description %></h6>
      <h6><i class="far fa-gem"></i> <%= @milestone.reward %></h6>
    </div>
    <div class="milestone-box2">
      <div class= "milestone-btns">
        <%= link_to "Destroy", guild_milestone_path(@milestone), method: :delete, data: {confirm: "Are you sure you wish to delete it?"}, class: "btn-milestone"%>
        <%= link_to "Completed", guild_milestone_path(@guild, @milestone, completed: true), method: :patch, class: "btn-milestone" %>
        <%= link_to "Activate", guild_milestone_path(@guild, @milestone, completed: false), method: :patch, class: "btn-milestone" %>
      </div>
      <div style="display: flex; justify-content: center;">
        <% if @milestone.completed %>
          <%="Status : #{@milestone.title} is completed"%>
        <% elsif @milestone.completed == false %>
          <%="Status : #{@milestone.title} is activated"%>
        <% end %>
      </div>
    </div>
  </div>
<div class="progress" style="width: 60vw; height: 15px; border-radius: 10px;">
  <div class="progress-bar progress-bar-striped progress-bar-animated bg-success" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: <%= @milestone.tasks.where(completed: true).present? ? 100 / @milestone.tasks.count * @milestone.tasks.where(completed: true).count : 0 %>%;" > <%= @milestone.tasks.where(completed: true).present? ? 100 / @milestone.tasks.count * @milestone.tasks.where(completed: true).count : 0 %>%</div>
</div>

  <div class="task-container" style="width: 60vw;">
    <div class="new-task-box">
      <button type="button" class="btn-new-task" data-toggle="modal" data-target="#form">
      <img src="https://blush.design/api/download?shareUri=EqOeLfC45&w=800&h=800&fm=png" alt="" style="margin-bottom: 5px;">
        Add new task
      </button>
    </div>
    <% @tasks.each do |task| %>
      <div class="task-box">
        <div class="task-box1">
          <div class="task-box-avatar">
            <img class="task-avatar" src="https://res.cloudinary.com/dx6rtf9wl/image/upload/v1614345377/john_aj1jop.jpg" alt="" style="border-radius: 50%; width: 3rem;" />
          </div>
          <div class="task-name"><%= task.user.full_name%></div>
        </div>
        <div class="task-box2">
          <div class="task-title"><i class="fas fa-thumbtack"></i> Task: <%= task.title %></div>
          <div class="task-description"><i class="fas fa-tasks"></i> <%= task.description %></div>
          <div class="task-status">
            <% if task.completed %>
             <p style="color: #b2402c"><i class="fas fa-check-square"></i> Task complete</p>
            <% else %>
              <p><i class="fas fa-exclamation-circle"></i> Task in progress</p>
            <% end %>
          </div>
          <div class="task-status-btn">
            <% if task.completed %>
              <%= link_to "Start task", milestone_task_path(@milestone, task, task: {completed: false}), method: :patch, class: "btn-milestone" %>
            <% else %>
              <%= link_to "Mark as complete", milestone_task_path(@milestone, task, task: {completed: true}), method: :patch, class: "btn-milestone" %>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
