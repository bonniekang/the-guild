
<div class="invites">
  <% if current_user.guildmemberships.where(status: "pending").present? %>
    <% current_user.guildmemberships.where(status: "pending").each do |membership| %>
      <p style="margin-top: 10px;">You have been invited to</p>
      <p><strong><%= membership.guild.name %></strong></p>
      <p>by <%= membership.guild.user.full_name %></p>
      <%= link_to "Accept", status_guild_guildmembership_path(membership.guild, membership, status: "approved"), class:"btn btn-success", method: :patch, remote: true %>
      <%= link_to "Reject", guild_guildmembership_path(membership.guild, membership), class:"btn btn-danger", method: :delete, remote: true%>
    <% end %>
  <% end %>
</div>
<div class="container guild-list-container">
  <% @guilds.each do |guild| %>
    <% if guild.guildmemberships.where(user: current_user, status: "approved").present? || guild.user == current_user  %>
    <div style="position: relative;">
      <%= link_to guild.name, guild_path(guild), class: "dashboard-guild-list", style: "background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url( #{guild.photo.attached? ? cl_image_path(guild.photo.key) : 'https://res.cloudinary.com/dx6rtf9wl/image/upload/v1614945426/download_jisl0t.jpg'})"%>
      <%= link_to "Leave", guild_guildmembership_path(guild, id: guild.guildmemberships.find_by(user: current_user, guild: guild)), method: :delete, data: { confirm: "Are you sure you wish to leave #{guild.name}"}, style: "position: absolute; right: 30px; top: 10px; padding: 5px;", class: "btn btn-danger", remote: true unless guild.user == current_user %>
    </div>
    <% end %>
  <% end %>
</div>
